<!DOCTYPE html>
<html>
<head>
	<title>发货计划</title>
	<link rel="stylesheet" type="text/css" href="../css/sentGoodPlan.css">
</head>
<body>
	<div class="select-box">
		<input type="text" id="input" />
		<select id="xiangMu"></select>
		<select id="louDong"></select>
		<select id="louCeng"></select>
		<button id="setSentTime">设置发货时间</button>
	</div>
	<div class="mt-30">
		<table border="1" cellpadding="0" cellspacing="0">
			<thead>
				<tr>
					<th colspan="5">1栋</th>
				</tr>
				<tr>
					<th class="special">
						<span>层数</span>
						<span>类型</span>
					</th>
					<th>PCB</th>
					<th>PCQ</th>
					<th>PCLT</th>
					<th>PCYT</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td rowspan="2">一层</td>
					<td>2018/12/12</td>
					<td>2018/12/12</td>
					<td>2018/12/12</td>
					<td>2018/12/12</td>
				</tr>
				<tr>
					<td>
						<p>
							<span>已发：2</span>
							<span class="ml-10">未发：3</span>
						</p>
						<p>最后发货时间</p>
						<p>2018/12/13</p>
					</td>
					<td>
						<p>
							<span>已发：2</span>
							<span>未发：3</span>
						</p>
						<p>最后发货时间</p>
						<p>2018/12/13</p>
					</td>
					<td>
						<p>
							<span>已发：2</span>
							<span>未发：3</span>
						</p>
						<p>最后发货时间</p>
						<p>2018/12/13</p>
					</td>
					<td>
						<p>
							<span>已发：2</span>
							<span>未发：3</span>
						</p>
						<p>最后发货时间</p>
						<p>2018/12/13</p>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	<script type="text/javascript" src="../js/jquery.js"></script>
	<script type="text/javascript" src="../js/common.js"></script>
	<script type="text/javascript">
		!(function(){
			$('#input').on('input',function(){
				getXiangMu();
			})
			function getXiangMu () {
		      myPost({
		        data: {
		          action: 'searchTradeObject',
		          forshort: $('#input').val()
		        },
		        successFn: function (data) {
		          if (status == 0) {
		            var str = '';
		            for (var i = 0, l = data.result.length; i < l; i++) {
		              str += "<option data-id='" + data.result[i].Id + "'>" + data.result[i].Forshort + "</option>"
		            }
		            $('#xiangMu').html(str);
		            getLouDong();
		          }
		        }
		      });
		    }
		    function getLouDong () {
		      myPost({
		        data: {
		          action: 'buildings',
		          tradeid: $('#xiangMu')[0][0].dataset.id
		        },
		        successFn: function (data) {
		          if (status == 0) {
		            var str = '';
		            for (var i = 0, l = data.result.length; i < l; i++) {
		              str += "<option data-id='" + data.result[i].TradeId + "'>" + data.result[i].BuildingNo + "</option>"
		            }
		            $('#louDong').html(str);
		            getLouCeng();
		          }
		        }
		      });
		    }
		    function getLouCeng () {
		      myPost({
		        data: {
		          action: 'buildings',
		          tradeid: $('#louDong')[0][0].dataset.id
		        },
		        successFn: function (data) {
		          if (status == 0) {
		            var str = '';
		            for (var i = 0, l = data.result.length; i < l; i++) {
		              str += "<option data-id='" + data.result[i].TradeId + "'>" + data.result[i].BuildingNo + "</option>"
		            }
		            $('#louCeng').html(str);
		          }
		          getTable();
		        }
		      });
		    }
		    function getTable(){
		      $('#address').html($('#xiangMu').val()+$('#louDong').val()+'栋'+$('#louCeng').val()+'层')
		      myPost({
		        data: {
		          action: 'getTradeSentPlan',
		          objectid: 34||$('#xiangMu')[0][0].dataset.id,
		          buildingno: 13||$('#louDong')[0][0].dataset.id,
		          floorno: 2||$('#louCeng')[0][0].dataset.id,
		        },
		        successFn: function (data) {
		        	console.log(data);
		          // if (status == 0) {
		          //   var str = '';
		          //   for (var i = 0, l = data.result.length; i < l; i++) {
		          //     str += "<tr data-id='"+data.result[i].Id+"''><td><input type='checkbox' class='checkbox'></td><td>"+(i-(-1))+"</td><td>"+data.result[i].CmptType+"</td><td>"+(data.result[i].RequestDateTime||"")+"</td><td>"+(data.result[i].Status==0?"未提交":data.result[i].Status==1?"已提交":"已审核")+"</td></tr>";
		          //   }
		          //   $('#tableList').html(str);
		          //   $('.checkbox').change(function(){
		          //     if($(this)[0].checked) $(this).parent().parent().addClass('active');
		          //     else $(this).parent().parent().removeClass('active');
		          //   });
		          // }
		        }
		      });
		    }
		    $('#xiangMu').on('change',function(){
		      getLouDong();
		    })
		    $('#louDong').on('change',function(){
		      getLouCeng();
		    })
		    $('#louCeng').on('change',function(){
		      getTable();
		    })
		})()
	</script>
</body>
</html>